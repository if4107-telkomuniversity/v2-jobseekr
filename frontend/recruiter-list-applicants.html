<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Applicant Summary | JobSeekr</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.min.css"
    />
    <link rel="stylesheet" href="css/app.css" />
    <script
      defer
      src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"
    ></script>
  </head>
  <body onload="callFunctions()">
    <nav
      class="white-background custom-nav"
      role="navigation"
      aria-label="main navigation"
    >
      <div class="columns">
        <div class="column is-4 navbar-left">
          <div class="navbar-brand">
            <a class="navbar-item" href="https://bulma.io">
              <img
                src="https://bulma.io/images/bulma-logo.png"
                width="112"
                height="28"
              />
            </a>

            <a
              role="button"
              class="navbar-burger burger"
              aria-label="menu"
              aria-expanded="false"
              data-target="navbarBasicExample"
            >
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
              <span aria-hidden="true"></span>
            </a>
          </div>
        </div>
        <div class="column is-5 navbar-center">
          <!-- <div class="field has-addons">
            <div class="control is-expanded">
              <input class="input" type="text" placeholder="Search jobs" />
            </div>
            <div class="control">
              <a class="button is-info">
                Search
              </a>
            </div>
          </div> -->
        </div>
        <div class="column is-2">
          <div class="navbar-item has-dropdown is-hoverable is-pulled-right">
            <a class="navbar-link jobseeker-name">
              {Username}
            </a>
            <div class="navbar-dropdown">
              <a class="navbar-item">
                <span class="icon is-small is-left">
                  <i class="fas fa-user-cog"></i>
                </span>
                &nbsp&nbsp Profile
              </a>
              <a class="navbar-item">
                <span class="icon is-small is-left">
                  <i class="fas fa-bug"></i>
                </span>
                &nbsp&nbsp Report an issue
              </a>
              <hr class="navbar-divider" />
              <a class="navbar-item" onClick="signout()">
                <span class="icon is-small is-left">
                  <i class="fas fa-sign-out-alt"></i>
                </span>
                &nbsp&nbsp Signout
              </a>
            </div>
          </div>
          <div class="column is-1"></div>
        </div>
      </div>
    </nav>
    <div class="columns">
      <div class="column is-2 side-menu">
        <aside class="menu white-background">
          <ul class="menu-list">
            <li>
              <a href="recruiter-dashboard.html" class="subtitle is-4">Jobs</a>
            </li>
            <li><a class="subtitle is-4">Post Job</a></li>
          </ul>
        </aside>
      </div>
    </div>
    <div class="column is-10">
      <div class="columns">
        <div class="column is-4"></div>
        <div class="column is-8" id="applicants">
          <h1 class="title is-3 push-right-a-bit">Applicants</h1>
          <div class="column is-10">
            <div class="box" id="job-list">
              <article class="media" onclick="seeAplicants(` + applicant.id + `)">
                <figure class="media-left">
                  <p class="image is-64x64">
                    <img
                      src="https://bulma.io/images/placeholders/128x128.png"
                    />
                  </p>
                </figure>
                <div class="media-content">
                  <div class="content">
                    <p>
                      <strong> {{jobseeker.name}}</strong> <br />
                      ({{job.type}}) <br />
                      {{job.city}}, Indonesia | IDR. {{job.salary}}<br />
                    </p>
                    <small class="is-pulled-right"
                        >Until {{date_expire}}
                      </small>
                  </div>
                </div>
              </article>
              <article class="media" onclick="seeAplicants(` + applicant.id + `)">
                <figure class="media-left">
                  <p class="image is-64x64">
                    <img
                      src="https://bulma.io/images/placeholders/128x128.png"
                    />
                  </p>
                </figure>
                <div class="media-content">
                  <div class="content">
                    <p>
                      <strong> {{job.position}} ({{job.type}})</strong> <br />
                      {{job.company.name}} <br />
                      {{job.city}}, Indonesia | IDR. {{job.salary}}<br />
                      <small class="is-pulled-right"
                        >Until {{date_expire}}
                      </small>
                    </p>
                  </div>
                </div>
              </article>
            </div>
            <nav class="pagination" role="navigation" aria-label="pagination">
                <a class="pagination-previous  has-background-white has-text-black">Previous</a>
                <a class="pagination-next  has-background-white has-text-black">Next page</a>
                <ul class="pagination-list">
                  <li>
                    <a class="pagination-link  has-background-white has-text-black" aria-label="Goto page 1">1</a>
                  </li>
                  <li>
                    <span class="pagination-ellipsis  has-background-white has-text-black">…</span>
                  </li>
                  <li>
                    <a class="pagination-link  has-background-white has-text-black" aria-label="Goto page 45">45</a>
                  </li>
                  <li>
                    <a class="pagination-link is-current" aria-label="Page 46" aria-current="page">46</a>
                  </li>
                  <li>
                    <a class="pagination-link  has-background-white has-text-black" aria-label="Goto page 47">47</a>
                  </li>
                  <li>
                    <span class="pagination-ellipsis  has-background-white has-text-black">…</span>
                  </li>
                  <li>
                    <a class="pagination-link  has-background-white has-text-black" aria-label="Goto page 86">86</a>
                  </li>
                </ul>
              </nav>
          </div>
        
        </div>
      
      </div>
      
    </div>
    
  </body>
  <script>

function seeAplicants(applicantId) {
    sessionStorage.setItem('applicantID', parseFloat(applicantId));
    window.location = 'application-detail.html';
  }

    function checkAuth() {
      // if (sessionStorage.getItem('email')) {
      // 	//do something
      // } else {
      // 	window.location = 'index.html';
      // }
    }

    function formatForUser() {
      var user = loadJobseeker(sessionStorage.getItem("email"));
      var jobseekerName = document.getElementsByClassName("jobseeker-name");
      for (i = 0; i < jobseekerName.length; i++) {
        jobseekerName[i].innerHTML = user.name;
        jobseekerName[i].value = user.name;
      }
      var jobseekerAddress = document.getElementsByClassName(
        "jobseeker-address"
      );
      for (i = 0; i < jobseekerAddress.length; i++) {
        jobseekerAddress[i].innerHTML = user.address;
        jobseekerAddress[i].value = user.address;
      }
      var jobseekerEmail = document.getElementsByClassName("jobseeker-email");
      for (i = 0; i < jobseekerEmail.length; i++) {
        jobseekerEmail[i].innerHTML = user.email;
        jobseekerEmail[i].value = user.email;
      }
      var jobseekerPhoneNumber = document.getElementsByClassName(
        "jobseeker-phone-number"
      );
      for (i = 0; i < jobseekerPhoneNumber.length; i++) {
        jobseekerPhoneNumber[i].innerHTML = user.phoneNumber;
        jobseekerPhoneNumber[i].value = user.phoneNumber;
      }
      var jobseekerSummary = document.getElementsByClassName(
        "jobseeker-summary"
      );
      for (i = 0; i < jobseekerSummary.length; i++) {
        jobseekerSummary[i].innerHTML = user.summary;
        jobseekerSummary[i].value = user.summary;
      }
    }

    function loadApplicantOfJob(jobId) {
      var params = {
        job_id: sessionStorage.getItem("jobId")
      };
      params = formatParams(params);
      var xhr = new XMLHttpRequest();
      xhr.open(
        "GET",
        "http://localhost:8000/job-application/pending" + params,
        false
      );
      xhr.send();
      var allApplicants = JSON.parse(xhr.response);
      allApplicants.forEach(loadApplicant);
    }

    function callFunctions() {
      checkAuth();
      formatForUser();
      loadApplicantOfJob();
    }
  </script>
</html>
